<html lang="en">
    <body>
        <div id="wrapper">
            <div ng-include="'navigationBar.html'"></div>
            <div id="page-wrapper">
                <br>
                <div id="warning-alert" class="alert alert-danger">
                    <h4><strong>Error!</strong> Http's request caused an error. Probably url is not correct.</h4>
                </div>
                <div class="col-lg-12">
                    <h1 class="page-header majordodo">Tasks</h1>
                </div>
                <div class="row">
                    <div class="col-lg-12">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                {{tasks.length}} results
                            </div>
                            <!-- /.panel-heading -->
                            <div class="panel-body">
                                <div class="form-group row">
                                    <div class="form-inline " >
                                        <div  class="col-md-10" >
                                            <div id="searchTaskId" class="col-sm-2" >
                                                <input class="form-control"  id="searchTaskId-input" placeholder="Search task ID" autocomplete="off" autofocus="autofocus" type="text" ng-keyup="keyPress($event)" onkeyup="toogleClassSuccess('searchtaskId')"ng-model="filters['searchTaskId']" >
                                            </div>
                                            <div id="searchUserId" class="col-sm-2" >
                                                <input class="form-control " id="searchUserId-input"  placeholder="Search user ID" autocomplete="off" autofocus="autofocus" type="text" ng-keyup="keyPress($event)" onkeyup="toogleClassSuccess('searchUserId')" ng-model="filters['searchUserId']" >
                                            </div>
                                            <div id="searchTasktype" class="col-sm-2 " >
                                                <input class="form-control" id="searchTasktype-input"  placeholder="Search task type" autocomplete="off" autofocus="autofocus" type="text" ng-keyup="keyPress($event)" onkeyup="toogleClassSuccess('searchTasktype')" ng-model="filters['searchTasktype']">
                                            </div>
                                            <div id="searchWorkerId" class="col-sm-2 " >
                                                <input class="form-control" id="searchWorkerId-input"  placeholder="Search worker ID" autocomplete="off" autofocus="autofocus" type="text" ng-keyup="keyPress($event)" onkeyup="toogleClassSuccess('searchWorkerId')" ng-model="filters['searchWorkerId']">
                                            </div>
                                            <div id="searchStatus" class="col-sm-2" >
                                                <input class="form-control" id="searchStatus-input"  placeholder="Search status" autocomplete="off" autofocus="autofocus" type="text" ng-keyup="keyPress($event)" onkeyup="toogleClassSuccess('searchStatus')" ng-model="filters['searchStatus']">
                                            </div>
                                            <div id="searchSlot"  class="col-sm-2" >
                                                <input class="form-control" id="searchSlot-input"  placeholder="Search slot" autocomplete="off" autofocus="autofocus" type="text" ng-keyup="keyPress($event)" onkeyup="toogleClassSuccess('searchSlot')" ng-model="filters['searchSlot']">
                                            </div>
                                        </div>
                                        <div  class="col-md-2" >
                                            <div id="searchMax"  class="col-xs-6" >
                                                <input class="form-control" id="searchMax-input"  placeholder="Max rows" autocomplete="off" autofocus="autofocus" type="text" ng-keyup="keyPress($event)" ng-model="max">
                                            </div>
                                            <div id="clear" class="col-xs-6" >
                                                <button type="button" class="btn btn-info" ng-click="clearFilters()">Clear all filters</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <table width="100%" class="table table-striped table-bordered table-hover" id="dataTables-example">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>User ID</th>
                                            <th>Tasktype</th>
                                            <th>Worker ID</th>
                                            <th>Status</th>
                                            <th>Slot</th>
                                        </tr>
                                    </thead>
                                    <tbody ng-repeat="task in tasks">
                                        <tr>
                                            <td class="{{colors[task.taskId]}}">
                                                {{task.taskId}}
                                                <div class="btn-group btn-group-xs pull-right">
                                                    <button id="{{task.taskId}}" type="button" class="btn btn-default taskdetails" data-toggle="modal" data-target="#myModal">Show task</button>
                                                    <button ng-click="searchThis(task.taskId, 'searchTaskId')" type="button" class="btn btn-default">Filter</button>
                                                </div>
                                                <!--popup with task details-->
                                                <div class="modal fade" id="myModal" role="dialog">
                                                    <div class="modal-dialog modal-sm">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                                <h4 class="modal-title">Task {{taskdetails.taskId}}</h4>
                                                            </div>
                                                            <div class="modal-body">

                                                                <table width="100%" class="table table-striped table-hover table-bordered " >
                                                                    <tbody >
                                                                        <tr>
                                                                            <th>
                                                                                User ID
                                                                            </th>
                                                                            <td>
                                                                                {{taskdetails.userId}}
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <th>
                                                                                Tasktype
                                                                            </th>
                                                                            <td>
                                                                                {{taskdetails.tasktype}}
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <th>
                                                                                Worker ID
                                                                            </th>
                                                                            <td>
                                                                                {{taskdetails.workerId}}
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <th>
                                                                                Status
                                                                            </th>
                                                                            <td>
                                                                                {{taskdetails.status}}
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <th>
                                                                                Slot
                                                                            </th>
                                                                            <td>
                                                                                {{taskdetails.slot}}
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <th>
                                                                                Attempts
                                                                            </th>
                                                                            <td>
                                                                                {{taskdetails.attempts}}
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <th>
                                                                                Max attempts
                                                                            </th>
                                                                            <td>
                                                                                {{taskdetails.maxattempts}}
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <th>
                                                                                Created
                                                                            </th>
                                                                            <td>
                                                                                {{taskdetails.createdTimestamp| date:"dd/MM/yyyy 'at' h:mm ' ' a"}}
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <th>
                                                                                Deadline
                                                                            </th>
                                                                            <td>
                                                                                {{taskdetails.deadline| date: "dd/MM/yyyy 'at' h:mm ' ' a"}}
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <th>
                                                                                Result
                                                                            </th>
                                                                            <td>
                                                                                {{taskdetails.result}}
                                                                            </td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                            <div class="modal-footer">
                                                                <button type="button" class="btn btn-info" data-dismiss="modal">Close</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!--popup with task details-->
                                            </td>
                                            <td class="{{colors[task.taskId]}}">{{task.userId}}
                                                <div class="btn-group btn-group-xs pull-right">
                                                    <button ng-click="searchThis(task.userId, 'searchUserId')" type="button" class="btn btn-default">Filter</button>
                                                </div>
                                            </td>
                                            <td class="{{colors[task.taskId]}}">{{task.tasktype}}
                                                <div class="btn-group btn-group-xs pull-right">
                                                    <button ng-click="searchThis(task.tasktype, 'searchTasktype')" type="button" class="btn btn-default">Filter</button>
                                                </div></td>
                                            <td class="{{colors[task.taskId]}}">
                                                {{task.workerId}}
                                                <div class="btn-group btn-group-xs pull-right">
                                                    <button ng-hide="!task.workerId" ng-click="searchThis(task.workerId, 'searchWorkerId')" type="button" class="btn btn-default">Filter</button>
                                                </div>
                                            </td>
                                            <td class="{{colors[task.taskId]}}">{{task.status}}
                                                <div class="btn-group btn-group-xs pull-right">
                                                    <button ng-click="searchThis(task.status, 'searchStatus')" type="button" class="btn btn-default">Filter</button>
                                                </div></td>
                                            <td class="{{colors[task.taskId]}}">{{task.slot}}
                                                <div class="btn-group btn-group-xs pull-right">
                                                    <button ng-click="searchThis(task.slot, 'searchSlot')" type="button" class="btn btn-default">Filter</button>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <!-- /.table-responsive -->
                            </div>
                            <!-- /.panel-body -->
                        </div>
                        <!-- /.panel -->
                    </div>
                    <!-- /.col-lg-12 -->
                </div>
                <!-- /.row -->

                <!-- /.row -->
            </div>
            <!-- /#page-wrapper -->

        </div>

    </body>

</html>
